<div class="span8" style="background-color:white">
    <div class="row-fluid">
        <div class="span6">
            <%=link_to blog_path(q.id) do%>
                <%if q.title.length>20%>
                  <h1><strong>&nbsp;&nbsp;&nbsp;<%= "#{q.title[0...20]}..."%></strong></h1>
                <%else%>
                  <h1><strong>&nbsp;&nbsp;&nbsp;<%= q.title%></strong></h1>
                <%end%>
                <hr style="height:1px;weight:10px;border:none;border-top:1px solid #000;margin-bottom:10px"/>
            <%end%>
        </div>
        
        <div style="float:right;font-size:17px;margin-top:13px;margin-right:20px">
            <strong>
            <%if current_user.nil?%>
                <%= link_to "修改",login_path%>
                <%= link_to "删除",login_path%>
            <%elsif current_user?(q.creator)%>
                <%= link_to "修改",edit_blog_path(q)%>
                <%= link_to '删除',blog_path(q) , method: :delete, data: { confirm: 'Are you sure?' } %>
            <%elsif current_user.user_role.eql?('teacher')&&(current_user.selected_courses-q.courses) != current_user.selected_courses%>
                <%= link_to '删除',blog_path(q) , method: :delete, data: { confirm: 'Are you sure?' } %>
            <%end%>
            </strong>
        </div>
    </div>
    <div class="row-fluid">
        <div style="margin-bottom:10px">
        <h4 style="display: inline;">所属课程:</h4>
        <% q.courses.each do|course| %>
            <span class="label label-success">&nbsp;<%= link_to "#{course.course_name}",course_path(course) %>&nbsp;</span>
        <% end %>
        </div>
        <h4 style="display: inline;">标签：</h4>
        <%q.keywords.each do|k|%>
            <span class="label label-info">&nbsp;<%= k.name%>&nbsp;</span>
        <%end%>
    </div>
    <div class="row-fluid">
        <div class="span1">
            <i class="glyphicons-icon user"></i>
        </div>
        <div class="span1" style="display:inline;font-size:20px;margin-top:16px;margin-left:0px">
           <%= link_to "#{q.creator.nickname}",user_path(q.creator)%>
        </div>
    </div>
        
    <%=link_to blog_path(q.id) do%>
    <div class="row-fluid">
            <div class="span2">
                <div class="xyxwM2L" style="background-color:#f6f6f6">
                    <p><%=q.created_at.day%><em>/<%=q.created_at.month%></em></p>
                </div>
            </div>
            <div class = "span6 offset1" style="margin-top:10px">
                  <%if q.content.length>100%>
                      <p><%= "#{q.content[0...100]}..." %></p>
                  <%else%>
                      <p><%= q.content %></p>
                  <%end%>
            </div>
    </div>
    <%end%>
    
    <div class="row-fluid" style="margin-top:20px;margin-left:13px">
        <div id="add_evalute-<%= q.id%>" style="display:inline">
            <%= render :partial => "knowledges/comments", :locals => { :knowledge => q }%>    
        </div>
        <div id="focus" style="display:inline">
            <%= render :partial => "knowledges/focus_link", :locals => { :knowledge => q }%>&nbsp;&nbsp;  
        </div>
        <div style="display:inline">
            <a class="ping"><%= num = q.getAllReplies.size%> 条评论</a>&nbsp;&nbsp;
            <%if num>0%>
                <div class="reply" style="display:none;" style="float:left;">
                        <%= render :partial => "knowledges/reply_show", :locals => { :q => q } %>  
                </div>
            <%end%>
        </div>
    </div>
    <div class="row-fluid">
        <div id="answer-<%= q.id%>" class="span11" style="display:inline;margin-left:20px;margin-bottom:10px">
            <%= render :partial => "knowledges/reply_answer", :locals => { :knowledge => q } %> 
        </div>
    </div>
    <div class="row-fluid">
        <hr style="height:1px;border:none;border-top:1px solid #000;opacity:0.3;margin-bottom:10px"/>
    </div>
</div>

<style>
/*! CSS Used from: http://eecs.pku.edu.cn/css/css.css */
    *{margin:0;padding:0;outline:none;-webkit-font-smoothing:antialiased;}
    em{font-style:normal;}
    .xyxwM2L{margin-left:50px;width:80px;height:80px}
    .xyxwM2L p{font-size:40px;font-family:Arial, Helvetica, sans-serif;padding-top:30px;color:#333333;}
    .xyxwM2L p em{display:block;font-size:24px;color:#333;margin-left:45px;margin-top:-10px;}
    .xyxwM2 li:hover .xyxwM2L p{color:#004aa2;}
    .xyxwM2 li:hover .xyxwM2L p em{color:#004aa2;}
    .not_ann .xyxwM2L{width:130px;text-align:center;padding-bottom:20px;background:#f6f6f6;}
    .not_ann .xyxwM2L p{padding-top:20px;}
    *:before,*:after{transition:all ease-in-out .5s;-webkit-transition:all ease-in-out .5s;-moz-transition:all ease-in-out .5s;-o-transition:all ease-in-out .5s;-ms-transition:all ease-in-out .5s;}
</style>