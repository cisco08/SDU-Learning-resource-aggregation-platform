<% provide(:question, 'class=active') %>
<%= render 'courses/header'%>
<div class="question-new">
  <button id="newButton" type="button" class="btn btn-primary">
    <% if log_in?%>
       <%=link_to "我要发布",question_new_path(:course_id => @course.id),method: :get%>
    <%else%>
       <%= link_to "我要发布", login_path(:message => "请先登录")%>
    <%end%>
   
  </button>
</div>
<div class="question-list">
  <ul class="list-group">
    <%if !@question.nil?%>
      <%@question.each do|q| %>
        <div class="container">
          <li class="list-group-item">
            <div class = "panel panel-default">
                <div class="panel-heading">
                  <h3><%=link_to "标题:#{q.title}",question_path(q.id)%></h3>
                   <div>
                    <strong>所属课程:</strong>
                    <% q.courses.each do|course| %>
                             <%= course.course_name %>&nbsp
                    <% end %>
                  </div>
                </div>
                <div class="panel-body">
                  <h3>内容:</h3>
                  <p><%= q.content %></p>
                </div>
                <div class="panel-footer" >
                  <p style="text-align:justify;width:300px;display:inline">author:<%= q.creator.username%>&nbsp;&nbsp;&nbsp;发布时间:<%= q.created_at.localtime.strftime('%Y-%m-%d %H:%M:%S')%>&nbsp
                  <div id="add_evalute-<%= q.id%>" style="display:inline">
                        <%= render :partial => "knowledges/comments", :locals => { :knowledge => q }%>    
                  </div>
                  <div id="answer-<%= q.id%>" style="display:inline">
                      <%= render :partial => "knowledges/reply_answer", :locals => { :knowledge => q } %> 
                  </div>
                  <div style="display:inline">
                     <a class="ping"><%= q.getReplies.size%> 条评论</a>&nbsp;
                     <div class="reply" style="display:none" style="float:left">
                       <%= render :partial => "knowledges/reply_show", :locals => { :q => q } %>  
                     </div>
                  </div>
                   <div id="focus" style="display:inline">
                        <%= render :partial => "knowledges/focus_link", :locals => { :knowledge => q }%>  
                   </div>
                  </p>
                </div>
                <div class="panel-footer">
                  <h4 style="display: inline;">标签：</h4>
                    <%q.keywords.each do|k|%>
                    <span class="label label-info">
                      &nbsp;<%= k.name%>&nbsp;
                    </span>
                    <%end%>
                </div>
            </div>
        </li>
      </div>
      <%end %>
    <%end%>
  </ul>
</div>
<script type="text/javascript">
  $(document).ready(function(){
      $.each($(".ping"),function(){
            $(this).bind("click",function(){
                  $(this).parent().children(".reply").slideToggle();
            });
      });
      
      $.each($(".answer-show-button"),function(){
            $(this).bind("click",function(){
                  $(this).parent().children(".answer-content").slideToggle();
            });
      });
  });
</script>
